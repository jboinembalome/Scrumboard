<!-- User profile -->

<button mat-icon-button [matMenuTriggerFor]="menu">
  <span class="relative">
    <span class="sr-only">Open user menu</span>
    @if ((isAuthenticated | async) && (currentUser | async)?.picture) {
      <img class="h-12 w-12 rounded-full" [src]="(currentUser | async)?.picture" />
    }
    @else {
      <mat-icon class="text-gray-400">account_circle</mat-icon>
    }
  </span>
</button>

<!-- Menu dropdown-->
<mat-menu [xPosition]="'before'" #menu="matMenu" class="bg-white dark:bg-gray-950">
  @if (isAuthenticated | async) {
    <div>
      <div>
        <span class="flex flex-col leading-none px-4 py-2 mx-2">
          <span class="text-xs text-gray-500 dark:text-gray-100">Signed in as</span>
          <span class="mt-1.5 text-sm font-medium dark:text-gray-100">{{(currentUser | async)?.name}}</span>
        </span>
      </div>
      <mat-divider class="my-2"></mat-divider>
    </div>
  }

  <blouppy-toggle class="cursor-pointer group flex items-center px-4 py-2 text-sm" text="Dark mode"
    [checked]="checkedDarkMode" (click)="updateChecked()">
    <span class="mr-3">
      <div class="group flex items-center">
        <mat-icon class="h-6 w-6 mr-1.5 ">dark_mode</mat-icon>
        <span class="text-sm font-medium">Dark mode</span>
      </div>
    </span>
  </blouppy-toggle>

  <a href="#"
    class="group flex items-center px-4 py-2 text-gray-400 hover:text-gray-500 dark:text-gray-100 dark:hover:text-gray-400">
    <mat-icon class="h-6 w-6 mr-1.5 flex-none">settings</mat-icon>
    <span class="text-sm font-medium">Settings</span>
  </a>
  <mat-divider class="my-2"></mat-divider>
  <app-login-menu [isAuthenticated]="isAuthenticated | async"></app-login-menu>
</mat-menu>